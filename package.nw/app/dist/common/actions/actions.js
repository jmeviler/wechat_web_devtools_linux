"use strict";function init(){var e=require("../../actions/webviewActions.js"),t=require("../../stores/webviewStores.js"),r=require("../../actions/windowActions.js"),o=require("../../common/request/request.js"),i=(require("../../config/errcodeConfig.js"),require("../log/log.js")),n=require("../../config/urlConfig.js"),a=n.getBbsTicket,s=n.checkApiAuth,p=n.getAuthList,c=n.setAuth;_exports={reBuild:function(){var r=t.getCurrentWebviewID();e.setWebviewAction(r,{act:"reBuild"})},showAbout:function(){r.showAbout()},showChangeLog:function(){nw.Shell.openExternal("https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html")},reload:function(){var r=t.getCurrentWebviewID();e.setWebviewAction(r,{act:"reLoad"})},goback:function(){var r=t.getCurrentWebviewID();e.setWebviewAction(r,{act:"goBack"})},goforward:function(){var r=t.getCurrentWebviewID();e.setWebviewAction(r,{act:"goForward"})},focusAddressBar:function(){var e=t.getCurrentWebviewID();r.focusAddressBar(e)},showSetting:function(){r.showSetting()},jumpBbs:function(){o({url:a,needToken:1},function(e,t,o){if(!e){var i=JSON.parse(o),n=i.open_ticket;n?nw.Shell.openExternal("https://developers.weixin.qq.com/welogin?devcode="+n):r.showConfirm({content:"登录社区失败 错误信息  "+o,type:"alert",callback:function(){}})}})},checkApiAuth:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=e.appid,n=e.ext_appid,a=e.platform;o({url:s+"?appid="+i+"&ext_appid="+n+"&platform="+(a?1:0)+"&_r="+Math.random(),method:"post",body:JSON.stringify({appid:e.ext_appid?e.ext_appid:e.appid,jsapi:t}),needToken:1},function(e,t,o){var i=void 0;try{i=JSON.parse(o)}catch(e){return void r("system error "+o)}var n=i.baseresponse,a=n?parseInt(n.errcode):0,s=n.errmsg;0===a?r(null,{desc:i.auth_desc,scope:i.scope,state:i.state}):r(s)})},getAuthList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=e.appid,n=e.ext_appid,a=e.platform;o({url:p+"?appid="+r+"&ext_appid="+n+"&platform="+(a?1:0)+"&_r="+Math.random(),method:"post",body:JSON.stringify({appid:e.ext_appid?e.ext_appid:e.appid}),needToken:1},function(e,r,o){var n=void 0;try{n=JSON.parse(o)}catch(e){return void t("system error "+o)}var a=n.baseresponse,s=a?parseInt(a.errcode):0;0===s?t(null,n.auth_item):(i.error("common/actions/actions.js getAuthList error "+s),t(s))})},setAuth:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=e.appid,a=e.ext_appid,s=e.platform;o({url:c+"?appid="+n+"&ext_appid="+a+"&platform="+(s?1:0)+"&_r="+Math.random(),method:"post",body:JSON.stringify({appid:e.ext_appid?e.ext_appid:e.appid,auth_item:t}),needToken:1},function(e,t,o){var n=void 0;try{n=JSON.parse(o)}catch(e){return void r("system error "+o)}var a=n.baseresponse,s=a?parseInt(a.errcode):0;0===s?r(null):(i.error("common/actions/actions.js setAuth error "+s),r(s))})}}}var _exports;init(),module.exports=_exports;