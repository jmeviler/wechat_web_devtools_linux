"use strict";function proxyServer(e){e=e||{};var r=this,t=e.port||DEFAULT_PORT,l=e.hostname||DEFAULT_HOST,o=e.rule||default_rule;requestHandler.setRules(o),r.httpProxyServer=null,async.series([function(e){r.httpProxyServer=http.createServer(requestHandler.userRequestHandler),e(null)},function(e){r.httpProxyServer.listen(t,l),e(null)},function(e){e(null)}],function(e,r){e?log.error("err when start proxy server : "+e):log.info("Http proxy started at "+l+":"+t)}),r.close=function(){r.httpProxyServer&&r.httpProxyServer.close(),log.info("ProxyServer closed :"+l+":"+t)}}var http=require("http"),async=require("async"),requestHandler=require("./lib/requestHandler.js"),log=require("../../log/log.js"),DEFAULT_PORT=8001,DEFAULT_HOST="localhost",default_rule=require("./lib/rule_default.js");module.exports.proxyServer=proxyServer;