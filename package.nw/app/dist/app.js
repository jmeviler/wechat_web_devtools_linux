"use strict";function init(){var e=require("../dist/lib/react.js"),n=require("../dist/lib/react-dom.js"),i=require("../dist/common/loadInit/init.js"),t=require("../dist/components/ContainController.js"),o=require("../dist/common/proxy/startProxy.js"),s=require("../dist/actions/windowActions.js"),r=require("../dist/actions/webviewActions.js"),d=require("../dist/stores/webviewStores.js"),u=require("../dist/stores/windowStores.js"),a=require("../dist/common/log/log.js"),c=require("../dist/common/shortCut/shortCut.js"),l=require("../dist/utils/syncMessage.js"),g=global.appConfig.isDev,w=u.getLastShow();nw.App.on("open",function(e){var n=tools.getArgsURL(e);if(n){a.info("index.js Reopen App with url: "+n);var i=d.getCurrentWebviewID();r.getA8keyWebview(i,{url:n,isSync:!0,from:"urlbar"})}nw.Window.get().focus()}),nw.App.argv.indexOf("inspect")!==-1&&tools.openInspectWin();var f=tools.getArgsURL(nw.App.argv);f&&(a.info("index.js Open App with url: "+f),r.setInitURL(f)),c.registerCommon(),"edit"===u.getLastShow()&&c.registerEdit();var m=void 0;window.addEventListener("resize",function(){clearTimeout(m),m=setTimeout(function(){s.resize(document.body.offsetHeight)},20)}),window.addEventListener("keydown",function(e){var n=e.keyCode;123===n&&e.preventDefault()}),!g&&!global.appConfig.isGamma&&window.addEventListener("contextmenu",function(e){e.preventDefault()}),Win.on("focus",function(){s.focus(),c.hasCommonRegistered||c.registerCommon(),"edit"!==w||c.hasEditRegistered||c.registerEdit()}),Win.on("blur",function(){s.blur(),c.hasCommonRegistered&&c.unRegisterCommon(),c.hasEditRegistered&&c.unRegisterEdit()}),u.on("LAST_SHOW_CHANGE",function(e){w=e,"edit"===e?c.hasEditRegistered||c.registerEdit():c.hasEditRegistered&&c.unRegisterEdit()}),u.on("EDITOR_FOCUS",function(){c.hasEditRegistered&&c.unRegisterEdit()}),u.on("EDITOR_BLUR",function(){c.hasEditRegistered||"edit"!==w||c.registerEdit()}),Win.on("navigation",function(e,n,i){a.info("index.js navigation "+n+" ignore"),nw.Shell.openExternal(n),i.ignore()}),Win.on("new-win-policy",function(e,n,i){a.info("index.js new-win-policy "+n+" ignore"),i.ignore()}),Win.on("close",function(){a.info("index.js close"),nw.App.quit()}),Win.setMinimumSize(nw.App.manifest.window.width,nw.App.manifest.window.height),document.addEventListener("mousewheel",function(e){e.ctrlKey&&e.preventDefault()}),o(function(o){i(),a.info("index.js init proxy with "+o+" success!!");var r=function(){s.resize(document.body.offsetHeight),n.render(e.createElement(t,null),document.querySelector("#container"))};"complete"===document.readyState?r():window.addEventListener("load",r),l.startSync()})}var tools=require("../dist/utils/tools.js"),Win=nw.Window.get();global.Win=Win,global.appConfig=tools.getAppConfig(),global.contentDocument=document,global.contentDocumentBody=document.body,global.contentWindow=window,global.nwWindow=nw.Window.get(),tools.up(init);