"use strict";function init(){var e=require("../../lib/react.js"),t=require("../../components/mask/mask.js"),l=require("../../cssStr/cssStr.js"),s=require("../../stores/windowStores.js"),o=require("../../common/actions/actions.js"),a=require("../../utils/newReport.js"),r=require("../../actions/projectActions.js"),n=e.createClass({displayName:"Menubar",getInitialState:function(){return{memory:0,show:"win32"===process.platform||global.appConfig.isDev?{}:l.displayNone,showSubMenu:null}},actionsClick:function(e){var t=e.target,l=t.dataset,s=l.type;if(s.startsWith("submenu")){var n=s.match(/-(.+)$/)[1];this.setState({showSubMenu:n===this.state.showSubMenu?null:n})}else"closeProject"==s?(r.close(),a("project_"+close,this.props.project.appid)):o[s]&&o[s](),this.setState({showSubMenu:null})},onMaskClick:function(e){this.setState({showSubMenu:null})},_bodyClick:function(e){},componentDidMount:function(){s.on("BODY_CLICK",this._bodyClick)},componentWillUnmount:function(){s.removeListener("BODY_CLICK",this._bodyClick)},getMenuTree:function(){function s(t){var o=[],r=!0,n=!1,i=void 0;try{for(var c,h=t[Symbol.iterator]();!(r=(c=h.next()).done);r=!0){var p=c.value;if(p.show){var u=[],m=p.type,b=null;p.children&&(u=1===p.level?e.createElement("ul",{className:"menubar-item-sub submenu-"+p.type,style:a.state.showSubMenu===m?{}:l.displayNone},s(p.children)):e.createElement("ul",{className:"menubar-item-sub submenu-"+p.type,style:a.state.showSubMenu===m?{}:l.displayNone},s(p.children))),p.shortcut&&(b=e.createElement("span",{className:"menubar-item-shortcut"},p.shortcut)),o.push(e.createElement("li",{"data-type":p.children?"submenu-"+m:null,className:"menubar-item app-no-drag"},e.createElement("a",{href:"javascript:;","data-type":p.children?"submenu-"+m:m,className:"menubar-item-link"},p.label,b),u))}}}catch(e){n=!0,i=e}finally{try{!r&&h.return&&h.return()}finally{if(n)throw i}}return o}var o="edit"===this.props.show;this.tree=[{label:"设置",type:"showSetting",show:!0,level:1},{label:"文件",type:"file",level:1,show:o,children:[{label:"新建文件",type:"newFile",shortcut:"Ctrl + N",show:o},{label:"保存",type:"save",shortcut:"Ctrl + S",show:o},{label:"保存所有文件",type:"saveAll",shortcut:"Shift + Ctrl + S",show:o},{label:"关闭文件",type:"closeFile",shortcut:"Ctrl + W",show:o},{label:"关闭项目",type:"closeProject",show:o}]},{label:"编辑",type:"edit",level:1,show:o,children:[{label:"选中地址栏",type:"focusAddressBar",show:!o},{label:"撤销",type:"undo",shortcut:"Ctrl + Z",show:o},{label:"重做",type:"redo",shortcut:"Shift + Ctrl + Z",show:o},{label:"复制",type:"copy",shortcut:"Ctrl + C",show:o},{label:"剪切",type:"cut",shortcut:"Ctrl + X",show:o},{label:"粘贴",type:"paste",shortcut:"Ctrl + V",show:o},{label:"左缩进",type:"unindent",shortcut:"Ctrl + [",show:o},{label:"右缩进",type:"indent",shortcut:"Ctrl + ]",show:o},{label:"格式化代码",type:"format",shortcut:"Shift + Alt + F",show:o},{label:"代码上移一行",type:"moveLineUp",shortcut:"Alt + ↑",show:o},{label:"代码下移一行",type:"moveLineDown",shortcut:"Alt + ↓",show:o},{label:"复制并向上粘贴",type:"copyLineUp",shortcut:"Shift + Alt + ↑",show:o},{label:"复制并向下粘贴",type:"copyLineDown",shortcut:"Shift + Alt + ↓",show:o}]},{label:"查找",type:"find",level:1,show:o,children:[{label:"搜索",type:"find",shortcut:"Ctrl + F",show:o},{label:"全局搜索",type:"globalFind",shortcut:"Shift + Ctrl + F",show:o},{label:"替换",type:"replace",shortcut:"Ctrl + H",show:o}]},{label:"界面",type:"view",level:1,show:o,children:[{label:"显示 / 隐藏模拟器",type:"toggleSimulatorView",shortcut:"Ctrl + F1",show:o},{label:"显示 / 隐藏目录树",type:"toggleFileTreeView",shortcut:"Ctrl + F2",show:o}]},{label:"跳转",type:"goto",level:1,show:o,children:[{label:"跳转到文件",type:"gotoFile",shortcut:"Ctrl + P",show:o},{label:"跳转到最近文件",type:"gotoRecentFile",shortcut:"Ctrl + E",show:o}]},{label:"工具",type:"tools",level:1,show:o,children:[{label:"编译",type:"reBuild",shortcut:"Ctrl + B",show:o}]},{label:"帮助",type:"help",level:1,show:!0,children:[{label:"开发文档",type:"jumpDoc",show:o},{label:"更新日志",type:"showChangeLog",show:!0},{label:"关于",type:"showAbout",show:!0}]},{label:"开发者社区",type:"jumpBbs",level:1,show:!0}];var a=this,r=this.tree,n=s(r),i=this.props.lastWinStatus,c="restore"===i.status?"operation-max-icon":"operation-recover-icon";return e.createElement("div",{className:"menubar-wrapper app-drag",style:this.state.show},e.createElement(t,{show:!!this.state.showSubMenu,zIndex:8192,onClick:this.onMaskClick}),e.createElement("ul",{className:"menubar",onClick:this.actionsClick,style:{zIndex:8192}},n),e.createElement("div",{className:"titlebar"},e.createElement("h1",null,"微信开发者工具 ",global.appVersion," ",global.appConfig.isBeta?"beta":"")),e.createElement("div",{className:"operation-area app-no-drag"},e.createElement("a",{href:"javascript:;",onClick:this.props.appMin,className:"operation-item"},e.createElement("i",{className:"operation-min-icon"})),e.createElement("a",{href:"javascript:;",onClick:this.props.appMax,className:"operation-item"},e.createElement("i",{className:c})),e.createElement("a",{href:"javascript:;",onClick:this.props.appQuit,className:"operation-item"},e.createElement("i",{className:"operation-close-icon"}))))},render:function(){return this.getMenuTree()}});_exports=n}var _exports;init(),module.exports=_exports;