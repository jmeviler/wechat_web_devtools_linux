"use strict";function init(){var e=require("../../../lib/react.js"),t=require("../../dropdown/dropdown.js"),s=require("../../../stores/windowStores.js"),i=require("../../../actions/windowActions.js"),n=require("../../../stores/projectStores.js"),a=(require("../../../weapp/utils/projectManager.js"),require("../../../weapp/utils/vendorManager.js")),c=(require("../../../common/log/log.js"),6048e5),o=function(e){i.showTipsMsg({msg:e,type:"error"})},r=e.createClass({displayName:"ProjectSetting",getInitialState:function(e){return this.tasksOnSave={},this.getInitState()},componentDidMount:function(){s.on("TOGGLE_NEW_FEACHE_CHECK_SHOW_STATUS",this._onToggleShowNewFeatureCheck),a.on("VENDOR_CONFIG_CHANGE",this._onVendorConfigChange)},componentWillUnmount:function(){s.removeListener("TOGGLE_NEW_FEACHE_CHECK_SHOW_STATUS",this._onToggleShowNewFeatureCheck),a.removeListener("VENDOR_CONFIG_CHANGE",this._onVendorConfigChange)},save:function(){var e=this.tasksOnSave;for(var t in e)e[t]&&e[t]();this.reset()},cancel:function(){this.reset()},onBaseLibSelected:function(e,t){var s=this,c=t;a.changeVendorVersion(c,function(e){return e?void o(e):(n.setProjectLibVersion(s.props.project.hash,c),s.setState({libVersionShow:!1,libVersion:c}),void i.showTipsMsg({msg:"基础库切换成功",type:"success"}))})},onCheckURLTLSChange:function(e){var t=this,s=!this.state.checkURLTLS;this.setState({checkURLTLS:s}),this.tasksOnSave.checkURLTLS=function(){n.setProjectUrlCheck(t.props.project.hash,s)}},onNewFeatureCheckChange:function(e){var t=this,s=!this.state.newFeatureCheck;this.setState({newFeatureCheck:s}),this.tasksOnSave.setNewFeatureCheck=function(){n.setProjectNewFeature(t.props.project.hash,{check:t.state.newFeatureCheck?1:0,show:t.state.showNewFeatureCheck,time:Date.now()})}},onEs6conversionChange:function(e){var t=this,s=!this.state.es6conversion;this.setState({es6conversion:s}),this.tasksOnSave.setEs6conversion=function(){n.setProjectEs6(t.props.project.hash,s)}},onMinifiedChange:function(e){var t=this,s=!this.state.minified;this.setState({minified:s}),this.tasksOnSave.setMinified=function(){n.setProjectMinified(t.props.project.hash,s)}},onPostcssChange:function(e){var t=this,s=!this.state.postcss;this.setState({postcss:s}),this.tasksOnSave.setPostcss=function(){n.setProjectPostCss(t.props.project.hash,s)}},getInitState:function(){var e=this.props.project,t=!1;Date.now()-e.newFeature.time<c&&(t=e.newFeature.show);var s=a.getVendorConfig();return{dropdownStyle:{width:"10rem",height:"2rem"},baseLibSelectedIndex:0,libVersionShow:!1,libVersion:e.libVersion,libs:s.libs||{},checkURLTLS:e.urlCheck,autoRefresh:e.watcher,saveBeforeCompile:e.saveBeforeCompile,showNewFeatureCheck:t,newFeatureCheck:e.newFeature.check,es6conversion:e.es6,minified:e.minified,postcss:e.postcss}},reset:function(){this.tasksOnSave={},this.setState(this.getInitState())},_onToggleShowNewFeatureCheck:function(e){this.setState({showNewFeatureCheck:e}),n.setProjectNewFeature(this.props.project.hash,{check:this.state.newFeatureCheck,show:e,time:Date.now()})},_onVendorConfigChange:function(e){this.setState({libs:e.libs||{}})},render:function(){if(!this.props.show)return null;var s=this.state.showNewFeatureCheck;return e.createElement("div",{className:"setting-sections"},e.createElement("section",{className:"setting-section"},e.createElement("div",{className:"setting-section-title"},"版本设置"),e.createElement("ul",{className:"setting-section-list"},e.createElement("li",{className:"setting-section-list-item"},e.createElement("div",{className:"option-name"},"基础库版本"),e.createElement("div",{className:"option-value"},e.createElement(t,{onItemSelected:this.onBaseLibSelected.bind(this),items:["1.1.0"],selectedIndex:this.state.baseLibSelectedIndex,dropdownStyle:this.state.dropdownStyle}))))),e.createElement("section",{className:"setting-section"},e.createElement("div",{className:"setting-section-title"},"开发环境设置"),e.createElement("ul",{className:"setting-section-list"},e.createElement("li",{className:"setting-section-list-item"},e.createElement("div",{className:"option-name"},"校验请求域名及 TLS 版本"),e.createElement("div",{className:"option-value"},e.createElement("label",{htmlFor:"checkURLTLSCheckbox",className:"ui-checkbox"},e.createElement("input",{id:"checkURLTLSCheckbox",type:"checkbox",checked:this.state.checkURLTLS,onChange:this.onCheckURLTLSChange.bind(this)}),e.createElement("i",{className:"ui-icon-check-square"}),e.createElement("i",{className:"ui-icon-square-o"})))),e.createElement("li",{className:"setting-section-list-item",style:s?{}:{display:"none"}},e.createElement("div",{className:"option-name"},"使用测试服务器进行预览"),e.createElement("div",{className:"option-value"},e.createElement("label",{htmlFor:"newFeatureCheckbox",className:"ui-checkbox"},e.createElement("input",{id:"newFeatureCheckbox",type:"checkbox",checked:this.state.newFeatureCheck,onChange:this.onNewFeatureCheckChange.bind(this)}),e.createElement("i",{className:"ui-icon-check-square"}),e.createElement("i",{className:"ui-icon-square-o"})))))),e.createElement("section",{className:"setting-section"},e.createElement("div",{className:"setting-section-title"},"上传代码预处理"),e.createElement("ul",{className:"setting-section-list"},e.createElement("li",{className:"setting-section-list-item"},e.createElement("div",{className:"option-name"},"ES6 转 ES5"),e.createElement("div",{className:"option-value"},e.createElement("label",{htmlFor:"es6Checkbox",className:"ui-checkbox"},e.createElement("input",{id:"es6Checkbox",type:"checkbox",checked:this.state.es6conversion,onChange:this.onEs6conversionChange.bind(this)}),e.createElement("i",{className:"ui-icon-check-square"}),e.createElement("i",{className:"ui-icon-square-o"})))),e.createElement("li",{className:"setting-section-list-item"},e.createElement("div",{className:"option-name"},"代码压缩"),e.createElement("div",{className:"option-value"},e.createElement("label",{htmlFor:"minifiedCheckbox",className:"ui-checkbox"},e.createElement("input",{id:"minifiedCheckbox",type:"checkbox",checked:this.state.minified,onChange:this.onMinifiedChange.bind(this)}),e.createElement("i",{className:"ui-icon-check-square"}),e.createElement("i",{className:"ui-icon-square-o"})))),e.createElement("li",{className:"setting-section-list-item"},e.createElement("div",{className:"option-name"},"样式自动补全"),e.createElement("div",{className:"option-value"},e.createElement("label",{htmlFor:"postcssCheckbox",className:"ui-checkbox"},e.createElement("input",{id:"postcssCheckbox",type:"checkbox",checked:this.state.postcss,onChange:this.onPostcssChange.bind(this)}),e.createElement("i",{className:"ui-icon-check-square"}),e.createElement("i",{className:"ui-icon-square-o"})))))))}});_exports=r}var _exports;init(),module.exports=_exports;