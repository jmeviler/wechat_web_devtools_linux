"use strict";function init(){var e=(require("path"),require("fs"),require("../../lib/react.js")),t=require("../../cssStr/cssStr.js"),i=require("../../stores/webviewStores.js"),a=(require("../../stores/windowStores.js"),require("../../actions/leftviewActions.js")),o=(require("../../weapp/utils/tools.js"),require("../../common/log/log.js"),require("../../weapp/utils/projectManager.js"),"white"),s="#000000",n=e.createClass({displayName:"WebviewHeader",getInitialState:function(){var e=this.props,t=e.project,i=e.appJSON,a=e.pageJSON,o="";return t&&(o=a.navigationBarTitleText||i.window.navigationBarTitleText||""),{title:o,webviewID:parseInt(this.props.webviewID),canGoBack:!1,showRightBtn:!0,showBarLoading:!1}},_upWebviewStatus:function(e,t){0!==e&&(t.canGoBack=!0),Object.assign(this.state,t),this.setState(this.state)},_cleanWebview:function(){this.state.webviewID;this.setState({title:"",showRightBtn:!0,showBarLoading:!1})},_setInterfaceFromPageFrame:function(e){var t=e.name;"setNavigationBarTitle"===t?this.setState({title:e.value}):"showNavigationBarLoading"===t?this.setState({showBarLoading:!0}):"hideNavigationBarLoading"===t&&this.setState({showBarLoading:!1})},_setInterfaceRes:function(e,t,i,a){i&&("hideOptionMenu"===t||"hideMenuItems"===t||"hideAllNonBaseMenuItem"===t?this.setState({showRightBtn:!1}):"showOptionMenu"!==t&&"showMenuItems"!==t&&"showAllNonBaseMenuItem"!==t||this.setState({showRightBtn:!0}))},showFooter:function(){"function"==typeof this.props.headerOperate&&this.props.headerOperate("showFooter")},componentDidMount:function(){var e=this.state.webviewID;i.on("SET_INTERFACE_RES_"+e,this._setInterfaceRes),i.on("UP_WEBVIEW_STATUS_"+e,this._upWebviewStatus),i.on("CLEAN_WEBVIEW_"+e,this._cleanWebview),i.on("SET_INTERFACT_FROMPAGEFRAME_"+e,this._setInterfaceFromPageFrame)},componentWillUnmount:function(){var e=this.state.webviewID;i.removeListener("CLEAN_WEBVIEW_"+e,this._cleanWebview),i.removeListener("SET_INTERFACE_RES_"+e,this._setInterfaceRes),i.removeListener("UP_WEBVIEW_STATUS_"+e,this._upWebviewStatus),i.removeListener("SET_INTERFACT_FROMPAGEFRAME_"+e,this._setInterfaceFromPageFrame)},handleRightClick:function(){a.clickRightHeader(this.state.webviewID)},goBack:function(e){this.props.goBack()},closeLocation:function(){this.goBack(),this.props.closeLocation()},chooseLocation:function(){this.goBack(),this.props.chooseLocation()},render:function(){var i=this.props,a=i.offset,n=i.hideBack,r=i.webviewID,c=i.project,l=(i.isMap,i.goBack,i.pageJSON),h=i.appJSON;if(this.props.isMap)return e.createElement("div",{style:{width:a.width},className:"simulator-hd"},e.createElement("div",{onClick:this.closeLocation,className:"simulator-hd-back"},e.createElement("span",null,"取消")),e.createElement("h3",{className:"simulator-hd-title"},"位置"),e.createElement("div",{onClick:this.chooseLocation,className:"simulator-hd-option"},"发送"));var w={width:a.width,backgroundColor:l.navigationBarBackgroundColor||h.window.navigationBarBackgroundColor||s},u=!n&&this.state.canGoBack?{}:t.visibilityHidden;0==r&&c&&(u=t.visibilityHidden);var d={};this.props.project||this.state.showRightBtn||(d=t.visibilityHidden);var p={color:l.navigationBarTextStyle||h.window.navigationBarTextStyle||o};"white"!==p.color&&"black"!==p.color&&(p.color="white");var m={borderColor:l.navigationBarTextStyle||h.window.navigationBarTextStyle||o};"white"!==m.color&&"black"!==m.color&&(m.color="white");var v="black"===p.color?"ui-icon-dots-black":"ui-icon-dots-white",g=this.state.title||l.navigationBarTitleText||h.window.navigationBarTitleText,B=this.props.showRecordWording?"  录音中...":"";return e.createElement("div",{style:w,className:"simulator-hd"},e.createElement("div",{onClick:this.goBack,style:u,className:"simulator-hd-back"},e.createElement("i",{className:"simulator-hd-back-icon",style:m}),e.createElement("span",{style:p},"返回")),e.createElement("h3",{className:"simulator-hd-title",style:p},this.state.showBarLoading?e.createElement("i",{className:"simulator-hd-title-loading"}):"",g,B),e.createElement("div",{style:d,onClick:this.showFooter,className:"simulator-hd-option"},e.createElement("i",{className:v})))}});_exports=n}var _exports;init(),module.exports=_exports;