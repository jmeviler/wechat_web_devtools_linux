"use strict";function init(){_exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=Object.assign({},{onMessage:function(){},onDisconnect:function(){}},t),this.msgQuery=[],this.hasInit=!1},_exports.prototype={init:function(t){this.port=t,this.onMessage(),this.onDisconnect(),this.hasInit=!0},onMessage:function(){var t=this;this.port.onMessage.addListener(function(s){t.options.onMessage(s)})},onDisconnect:function(){var t=this;this.port.onDisconnect.addListener(function(){delete t.port,t.msgQuery=[],t.hasInit=!1,t.options.onDisconnect()})},postMessage:function(t,s,n,o){var i=this,e={to:t,msg:s,command:n,ext:o},r=this.port;return r?(this.msgQuery.length&&(this.msgQuery.forEach(function(t){i.port.postMessage(t)}),this.msgQuery=[]),void r.postMessage(e)):void this.msgQuery.push(e)}}}var _exports;init(),module.exports=_exports;