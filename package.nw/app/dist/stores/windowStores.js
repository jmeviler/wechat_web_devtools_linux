"use strict";function init(){var t,e,i=require("events").EventEmitter,o=require("../common/log/log.js"),n=(require("../utils/tools.js"),50),r=37,s=0,c="",u=JSON.parse(localStorage.getItem("userInfo"))||{},a={},S={},f=JSON.parse(localStorage.getItem("setting"))||{},l=f.proxyType||"SYSTEM",m=!1,O={accelerometer:!1},g=Object.assign({},i.prototype,{showTipsMsg:function(t){this.emit("SHOW_TIPS_MSG",t)},getProxySetting:function(){return l},updataProxySetting:function(t,e){l=t,o.info("windowStores.js updataProxySetting "+t);var i=require("../common/proxy/setAppProxy.js");i.up(function(){e()})},getInitInfo:function(){return o.info("windowStores.js getInitInfo "+JSON.stringify(a)+" "+JSON.stringify(S)),{urlConfig:a,clientConfig:S}},showAbout:function(){this.emit("SHOW_ABOUT_LAYER")},showLoginLayer:function(){this.emit("SHOW_LOGIN_LAYER")},getItemH:function(){return t},clearUserInfo:function(t){u={};for(var e in localStorage)0!==e.indexOf("projectattr")&&0!==e.indexOf("last-up-test-time")||localStorage.removeItem(e);localStorage.removeItem("userInfo"),localStorage.removeItem("last-select-project"),this.emit("UPDATA_USER_INFO",u),this.showLoginLayer()},getAutoComplete:function(){return e=JSON.parse(localStorage.getItem("autoComplete"))||[]},setAutoComplete:function(t){t=(t||"").trim(),e||(e=[]);var i=e.findIndex(function(e){return e===t});t&&i===-1&&t.indexOf("chrome-extension")===-1&&(e.push(t),localStorage.setItem("autoComplete",JSON.stringify(e))),this.emit("UPDATA_AUTOCOMPLETE",e)},getUserInfo:function(){if(u){var t=+new Date;t>u.signatureExpiredTime&&(u={},localStorage.removeItem("userInfo"))}return u},updateUserInfo:function(t){u=t;var e=JSON.stringify(t);localStorage.setItem("userInfo",e),o.info("windowStores.js updateUserInfo "+e),this.emit("UPDATA_USER_INFO",t)},upUserTikcet:function(t,e){u.newticket=t,u.ticketExpiredTime=e,localStorage.setItem("userInfo",JSON.stringify(u)),o.info("windowStores.js upUserTikcet newticket: "+t+" ticketExpiredTime: "+e)},delUserTicket:function(){u.ticketExpiredTime=+new Date-100,localStorage.setItem("userInfo",JSON.stringify(u)),o.info("windowStores.js delUserTicket ticketExpiredTime: "+u.ticketExpiredTime)},resize:function(e){t=e-n-r,this.emit("TOGGLE_SHARE_MENUS",t)},focus:function(){this.emit("WINDOW_FOCUS")},blur:function(){this.emit("WINDOW_BLUR")},bodyClick:function(t){this.emit("BODY_CLICK",t)},focusAddressBar:function(t){this.emit("FOCUS_ADDRESSBAR",t)},clearAddressHistory:function(t){e=[],localStorage.setItem("autoComplete",JSON.stringify(e)),this.emit("UPDATA_AUTOCOMPLETE",e,t),t.callBack&&t.callBack()},showSetting:function(){this.emit("SHOW_SETTING")},changeDevtools:function(){this.emit("CHANGE_DEVTOOLS")},getSetting:function(){var t=localStorage.getItem("setting")||"{}";return t&&(t=JSON.parse(t),t.currentProxyHost=t.proxyHost,t.currentProxyPort=t.proxyPort,void 0===t.device&&(void 0===t.os&&(t.os="iOS"),"iOS"===t.os?t.device="iPhone 6":t.device="Nexus 5x")),t},saveSetting:function(t){var e=Object.assign(f,t);t=JSON.stringify(e),o.info("windowStores.js saveSetting: "+t+" "),localStorage.setItem("setting",t)},getCurrentWebviewID:function(){return s},getCurrentWebviewUrl:function(){return c},changeUrl:function(t,e){s=e,c=t,this.emit("CHANGE_WEBVIEW_URL",t,e)},closeDevtools:function(t){this.emit("CLOSE_WEBVIEW_DEVTOOLS",t)},openDevtools:function(t,e,i){this.emit("OPEN_WEBVIEW_DEVTOOLS",t,e,i)},setInfo:function(t){var e=t.device,i=t.os,o=this.getSetting();o.os===i&&o.device===e||(o.os=i,o.device=e,this.saveSetting(o)),this.emit("SET_WEBVIEW_INFO",t)},appEnterBackground:function(){this.emit("APP_ENTER_BACKGROUND")},appEnterForeground:function(t){this.emit("APP_ENTER_FOREGROUND",t)},clickToolsbar:function(t){this.emit("CLICK_TOOLSBAR",t)},operateMusicPlayer:function(t){this.emit("OPERATE_MUSIC_PLAY",t)},getMusicPlayState:function(t){this.emit("GET_MUSIC_PLAY_STATE",t)},startDebuggee:function(t,e){this.emit("START_WEBVIEW_DEBUGGEE",t,e)},changeWebviewID:function(t){this.emit("WINDOW_CHANGE_WEBVIEW_ID",t)},getWeappError:function(t,e,i){this.emit("WINDOW_GET_WEBAPP_ERROR",t,e,i)},showWeappError:function(t,e){this.emit("WINDOW_SHOW_WEBAPP_ERROR",t,e)},showConfirm:function(t){this.emit("WINDOW_SHOW_CONFIRM",t)},showSimulatorConfirm:function(t){this.emit("WINDOW_SHOW_SIMULATOR_CONFIRM",t)},openProjectFile:function(t){this.emit("OPEN_PROJECT_FILE",t)},getLastShow:function(){return localStorage["last-show"]||"debug"},setLastShow:function(t){localStorage["last-show"]=t},setLastWinStatus:function(t){localStorage.setItem("last-winStatus",JSON.stringify(t))},getLastWinStatus:function(t){var e=localStorage.getItem("last-winStatus");return e?(e=JSON.parse(e),e.x=e.x<-300?-300:e.x,e.x=e.x>1024?1024:e.x,e.y=e.y<0?0:e.y,e.y=e.y>1024?1024:e.y,e):null},toggleNewFeatureCheckShowStatus:function(t){this.emit("TOGGLE_NEW_FEACHE_CHECK_SHOW_STATUS",t)},showCustomPreview:function(t){this.emit("SHOW_CUSTOM_PREVIEW",t)},showAuthorizeConfirm:function(t){this.emit("WINDOW_SHOW_AUTHORIZE_CONFIRM",t)},editorFocus:function(){m=!0,this.emit("EDITOR_FOCUS")},editorBlur:function(){m=!1,this.emit("EDITOR_BLUR")},isEditorFocus:function(){return m},getSensorStatus:function(){return O},setSensorStatus:function(t){O=t,this.emit("SENSOR_STATUS_CHANGE",t)}});_exports=g}var _exports;init(),module.exports=_exports;