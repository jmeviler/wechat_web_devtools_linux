"use strict";function init(){function e(e,r,t){var o=r.project,i=o.projectpath,s=n.join(i,e);h(s,i,function(r,n){if(r)t({httpCode:500,file:e,msg:r.toString().replace(/\\/g,"\\\\"),type:g});else{n=n.reverse().map(function(e){return e.replace(/\\/g,"/")});var i=n.concat(["-js","-db"]),s=u(p,i,{cwd:o.projectpath}),a=[],c=[];s.on("close",function(r){0===r?(m[o.hash]||(m[o.hash]={}),m[o.hash][e]=Buffer.concat(a).toString(),t(null,m[o.hash][e])):t({httpCode:500,file:e,msg:Buffer.concat(c).toString(),type:d})}),s.stdout.on("data",function(e){a.push(e)}),s.stderr.on("data",function(e){c.push(e)})}})}var r="darwin"===process.platform,t=global.appConfig.isDev,n=(require("fs"),require("path")),o=(require("../utils/tools.js"),require("url")),i=require("../utils/projectManager.js"),s=require("../../config/dirConfig.js"),a=s.WeappVendor,c=t?n.join(__dirname,"../vendor/"):a,p=r?n.join(c,"wcsc"):n.join(c,"wcsc.exe"),u=require("child_process").spawn,h=require("../commit/getallwxss.js"),f=require("mkdir-p"),l=require("../../config/config.js"),d=l.WXSS_ERROR,g=l.WXSS_IMPORT_ERROR,j=s.WeappBuildCache;f.sync(j);var m={};i.manager.on("FILE_CHANGE",function(e,r,t){".wxss"===n.extname(t)&&delete m[e.hash]}),_exports=function(r,t,n){var i=t.project,s=o.parse(r),a=s.pathname;return m[i.hash]&&m[i.hash][a]?void process.nextTick(function(){n(null,m[i.hash][a])}):void e(a,{project:i},n)}}var _exports;init(),module.exports=_exports;